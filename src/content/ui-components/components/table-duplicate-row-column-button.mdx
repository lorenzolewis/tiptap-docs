---
title: Table Duplicate Row/Column Button
meta:
  title: Table Duplicate Row/Column Button | Tiptap UI Components
  description: A button component and hook for duplicating table rows and columns in Tiptap editors, with intelligent validation and merged cell handling.
  category: UI Components
component:
  name: Table Duplicate Row/Column Button
  description: A prebuilt button component and hook for duplicating table rows and columns with all content preserved.
  type: component
  isFree: false
  isCloud: false
  isOpen: false
  isNew: true
  icon: TableIcon
tags:
  - type: start
---

import { CodeDemo } from '@/components/CodeDemo'

A button component and custom hook for duplicating table rows and columns in Tiptap editors. Supports creating exact copies of rows and columns with all content, formatting, and attributes preserved, while intelligently preventing operations on tables with merged cells.

<CodeDemo
  isScrollable
  src="https://template.tiptap.dev/preview/tiptap-ui/table-duplicate-row-column-button"
/>

## Installation

Add the component via the Tiptap CLI:

```bash
npx @tiptap/cli@latest add table-duplicate-row-column-button
```

## Components

### `<TableDuplicateRowColumnButton />`

A prebuilt button component for triggering row/column duplication operations.

#### Usage

```tsx
import { TableDuplicateRowColumnButton } from '@/registry/tiptap-ui/table-duplicate-row-column-button'

function MyDuplicateButton() {
  return <TableDuplicateRowColumnButton editor={editor} index={0} orientation="row" />
}
```

### Props

| Name                  | Type             | Default     | Description                                                                     |
| --------------------- | ---------------- | ----------- | ------------------------------------------------------------------------------- |
| `editor`              | `Editor \| null` | `undefined` | The Tiptap editor instance                                                      |
| `index`               | `number`         | `undefined` | The index of the row or column to duplicate. If omitted, uses current selection |
| `orientation`         | `Orientation`    | `undefined` | Whether duplicating a "row" or "column". Uses context if omitted                |
| `tablePos`            | `number`         | `undefined` | The position of the table in the document                                       |
| `hideWhenUnavailable` | `boolean`        | `false`     | Hide the button when duplication isn't currently possible                       |
| `onDuplicated`        | `() => void`     | `undefined` | Callback function called after a successful duplication                         |
| `text`                | `string`         | `undefined` | Optional text to display alongside the icon                                     |
| `...buttonProps`      | `ButtonProps`    | -           | All other props from the base Button component                                  |

## Hook

### `useTableDuplicateRowColumn(config)`

For custom button implementations, use the hook directly:

#### Usage

```tsx
import { useTableDuplicateRowColumn } from '@/registry/tiptap-ui/table-duplicate-row-column-button'

function CustomDuplicateButton() {
  const { isVisible, handleDuplicate, label, canDuplicateRowColumn, Icon } =
    useTableDuplicateRowColumn({
      orientation: 'row',
      hideWhenUnavailable: true,
    })

  if (!isVisible) return null

  return (
    <button onClick={handleDuplicate} disabled={!canDuplicateRowColumn}>
      <Icon />
      {label}
    </button>
  )
}
```

### Hook Configuration

The `UseTableDuplicateRowColumnConfig` interface supports the following options:

| Name                  | Type             | Default     | Description                                                                     |
| --------------------- | ---------------- | ----------- | ------------------------------------------------------------------------------- |
| `editor`              | `Editor \| null` | `undefined` | The Tiptap editor instance. Uses context if omitted                             |
| `index`               | `number`         | `undefined` | The index of the row or column to duplicate. If omitted, uses current selection |
| `orientation`         | `Orientation`    | `undefined` | Whether duplicating a "row" or "column". If omitted, uses current selection     |
| `tablePos`            | `number`         | `undefined` | The position of the table in the document                                       |
| `hideWhenUnavailable` | `boolean`        | `false`     | Hide when duplication isn't currently possible                                  |
| `onDuplicated`        | `() => void`     | `undefined` | Callback function called after a successful duplication                         |

### Hook Return Values

| Name                    | Type                  | Description                                             |
| ----------------------- | --------------------- | ------------------------------------------------------- |
| `isVisible`             | `boolean`             | Whether the button should be shown                      |
| `handleDuplicate`       | `() => void`          | Function to execute the duplication operation           |
| `label`                 | `string`              | Accessible label for the button (e.g., "Duplicate row") |
| `canDuplicateRowColumn` | `boolean`             | Whether duplication is currently possible               |
| `Icon`                  | `React.ComponentType` | The copy icon component for the duplicate action        |

## Usage Examples

### Standalone Button

```tsx
'use client'

import { EditorContent, useEditor } from '@tiptap/react'
import { StarterKit } from '@tiptap/starter-kit'
import { TableKit } from '@/registry/tiptap-node/table-node/table-node-extension'
import { TableHandle as TableHandleExtension } from '@/registry/tiptap-extension/table-handle'
import { TableDuplicateRowColumnButton } from '@/registry/tiptap-ui/table-duplicate-row-column-button'

export const StandaloneExample = () => {
  const editor = useEditor({
    extensions: [StarterKit, TableKit, TableHandleExtension],
    content: `
      <table>
        <tbody>
          <tr>
            <th><p><strong>Name</strong></p></th>
            <th><p><strong>Age</strong></p></th>
            <th><p><strong>City</strong></p></th>
          </tr>
          <tr>
            <td><p>Alice</p></td>
            <td><p>30</p></td>
            <td><p>New York</p></td>
          </tr>
          <tr>
            <td><p>Bob</p></td>
            <td><p>25</p></td>
            <td><p>London</p></td>
          </tr>
          <tr>
            <td><p>Carol</p></td>
            <td><p>35</p></td>
            <td><p>Tokyo</p></td>
          </tr>
        </tbody>
      </table>
    `,
  })

  return (
    <div>
      <EditorContent editor={editor} />
      <div style={{ marginTop: 10 }}>
        <TableDuplicateRowColumnButton
          editor={editor}
          index={1}
          orientation="row"
          text="Duplicate Row 1"
        />
        <TableDuplicateRowColumnButton
          editor={editor}
          index={1}
          orientation="column"
          text="Duplicate Column 1"
        />
      </div>
    </div>
  )
}
```

### With Table Handle Integration

```tsx
'use client'

import { useCallback, useMemo, useState } from 'react'
import { EditorContent, EditorContext, useEditor } from '@tiptap/react'
import { StarterKit } from '@tiptap/starter-kit'
import { TableKit } from '@/registry/tiptap-node/table-node/table-node-extension'
import { TableHandle as TableHandleExtension } from '@/registry/tiptap-extension/table-handle'
import { useTableDuplicateRowColumn } from '@/registry/tiptap-ui/table-duplicate-row-column-button'
import { TableHandle } from '@/registry/tiptap-ui/table-handle'
import type { TableHandleButtonProps } from '@/registry/tiptap-ui/table-handle'
import { Button } from '@/registry/tiptap-ui-primitive/button'
import {
  Menu,
  MenuButton,
  MenuContent,
  MenuGroup,
  MenuItem,
} from '@/registry/tiptap-ui-primitive/menu'
import { Combobox, ComboboxList } from '@/registry/tiptap-ui-primitive/combobox'
import { MoreVerticalIcon } from '@/registry/tiptap-icons/more-vertical-icon'
import type { Orientation } from '@/registry/lib/tiptap-table-utils'
import { cn, SR_ONLY } from '@/registry/lib/tiptap-utils'

const MENU_PLACEMENT_MAP: Record<Orientation, React.ComponentProps<typeof Menu>['placement']> = {
  row: 'top-start',
  column: 'bottom-start',
}

export const TableHandleIntegrationExample = () => {
  const editor = useEditor({
    immediatelyRender: false,
    extensions: [StarterKit, TableKit, TableHandleExtension],
    content: `
      <h2>Table Duplicate Row/Column Demo</h2>
      <p>
        Hover over the table to see handle buttons. Click the menu to duplicate rows and columns. 
        All content, formatting, and attributes will be preserved in the duplicate.
      </p>
      <table>
        <tbody>
          <tr>
            <th><p><strong>Country</strong></p></th>
            <th><p><strong>Capital</strong></p></th>
            <th><p><strong>Language</strong></p></th>
          </tr>
          <tr>
            <td><p>Spain</p></td>
            <td><p>Madrid</p></td>
            <td><p>Spanish</p></td>
          </tr>
          <tr>
            <td><p>Germany</p></td>
            <td><p>Berlin</p></td>
            <td><p>German</p></td>
          </tr>
          <tr>
            <td><p>Indonesia</p></td>
            <td><p>Jakarta</p></td>
            <td><p>Indonesian</p></td>
          </tr>
          <tr>
            <td><p>Netherlands</p></td>
            <td><p>Amsterdam</p></td>
            <td><p>Dutch</p></td>
          </tr>
        </tbody>
      </table>
    `,
  })

  return (
    <EditorContext.Provider value={{ editor }}>
      <EditorContent editor={editor} className="control-showcase" />
      <TableHandle editor={editor} rowButton={DuplicateMenu} columnButton={DuplicateMenu} />
    </EditorContext.Provider>
  )
}

function DuplicateMenu(props: TableHandleButtonProps) {
  const { editor, index, tablePos, orientation, onToggleOtherHandle } = props
  const [isMenuOpen, setIsMenuOpen] = useState(false)

  const duplicateAction = useTableDuplicateRowColumn({
    index,
    tablePos,
    orientation,
    hideWhenUnavailable: false,
    onDuplicated: () => console.log('Duplicated!'),
  })

  const menuPlacement = useMemo(() => MENU_PLACEMENT_MAP[orientation], [orientation])

  const handleMenuToggle = useCallback(
    (isOpen: boolean) => {
      setIsMenuOpen(isOpen)

      if (isOpen) {
        editor.commands.freezeHandles()
        onToggleOtherHandle?.(false)
      } else {
        editor.commands.unfreezeHandles()
        onToggleOtherHandle?.(true)
      }
    },
    [editor, onToggleOtherHandle],
  )

  return (
    <Menu
      open={isMenuOpen}
      onOpenChange={handleMenuToggle}
      placement={menuPlacement}
      trigger={
        <MenuButton
          className={cn('tiptap-table-handle-menu', isMenuOpen && 'menu-opened', orientation)}
        >
          <MoreVerticalIcon className="tiptap-button-icon" />
        </MenuButton>
      }
    >
      <MenuContent autoFocusOnShow modal>
        <Combobox style={SR_ONLY} />
        <ComboboxList>
          <MenuGroup>
            <MenuItem
              render={<Button data-style="ghost" data-active-state="off" />}
              onClick={duplicateAction.handleDuplicate}
              disabled={!duplicateAction.canDuplicateRowColumn}
            >
              <duplicateAction.Icon className="tiptap-button-icon" />
              <span className="tiptap-button-text">{duplicateAction.label}</span>
            </MenuItem>
          </MenuGroup>
        </ComboboxList>
      </MenuContent>
    </Menu>
  )
}
```

### Using Hook with Custom Button

```tsx
'use client'

import { useTableDuplicateRowColumn } from '@/registry/tiptap-ui/table-duplicate-row-column-button'

function CustomDuplicateControls() {
  const duplicateRow = useTableDuplicateRowColumn({
    orientation: 'row',
    hideWhenUnavailable: true,
    onDuplicated: () => console.log('Row duplicated!'),
  })

  const duplicateColumn = useTableDuplicateRowColumn({
    orientation: 'column',
    hideWhenUnavailable: true,
  })

  return (
    <div>
      {duplicateRow.isVisible && (
        <button
          onClick={duplicateRow.handleDuplicate}
          disabled={!duplicateRow.canDuplicateRowColumn}
          aria-label={duplicateRow.label}
        >
          <duplicateRow.Icon />
          {duplicateRow.label}
        </button>
      )}
      {duplicateColumn.isVisible && (
        <button
          onClick={duplicateColumn.handleDuplicate}
          disabled={!duplicateColumn.canDuplicateRowColumn}
          aria-label={duplicateColumn.label}
        >
          <duplicateColumn.Icon />
          {duplicateColumn.label}
        </button>
      )}
    </div>
  )
}
```

## Behavior

### Content Preservation

The component performs comprehensive content duplication:

1. **Cell attributes** - All cell attributes (alignment, background color, etc.) are copied
2. **Cell content** - The entire content tree inside each cell is duplicated
3. **Cell marks** - Any marks on the cell node are preserved
4. **Structure** - The cell structure remains identical to the source

### Merged Cell Detection

The component performs validation to prevent duplications that would create invalid table structures:

1. **Checks source cells** - Validates that the row/column being duplicated doesn't contain merged cells (`rowspan > 1` or `colspan > 1`)
2. **Prevents duplication** - When merged cells are detected, the duplication is automatically disabled
3. **Uses `getRowOrColumnCells`** - Utility function that identifies all cells and specifically tracks merged cells

When merged cells are detected in the source position, duplication is not possible to maintain table integrity.

### Selection Handling

The component handles two types of selections:

1. **CellSelection** - When multiple cells are selected, duplicates the selected row/column
2. **Regular selection** - When cursor is in a single cell, duplicates that row/column

For regular selections, the component:

- Creates a temporary cell selection for the source row/column
- Executes the add operation
- Replaces content in the new row/column
- Updates selection to the duplicated position

## Requirements

### Dependencies

- `@tiptap/react` - Core Tiptap React integration
- `@tiptap/pm/tables` - ProseMirror table utilities (CellSelection, addRowAfter, addColumnAfter)
- `react` - React framework

### Required Extensions

- `tableHandle` - Table handle extension for detecting row/column context
- `table` - Table node extension (TableKit)

### Required Components (for full example)

- `Button` (UI primitive) - Base button component
- `Menu`, `MenuButton`, `MenuContent`, `MenuItem` (UI primitives) - Menu components
- `TableHandle` - For hover-based table manipulation

### Referenced Utilities

- `useTiptapEditor` (hook) - Custom hook for editor instance management
- `tiptap-table-utils` (lib) - Utility functions:
  - `getTable` - Get table node information
  - `getTableSelectionType` - Determine selection type
  - `getRowOrColumnCells` - Get cells in a row/column and detect merged cells
  - `selectCellsByCoords` - Select cells by coordinates
  - `getIndexCoordinates` - Get cell coordinates for an index
  - `updateSelectionAfterAction` - Update selection after duplication
- `tiptap-utils` (lib) - Utility functions:
  - `isExtensionAvailable` - Check if an extension is available

## Related Components

- **[Table Handle](/ui-components/components/table-handle)** - For hover-based row/column manipulation
- **[Table Move Row/Column Button](/ui-components/components/table-move-row-column-button)** - For moving rows and columns
- **[Table Delete Row/Column Button](/ui-components/components/table-delete-row-column-button)** - For deleting rows and columns
- **[Table Add Row/Column Button](/ui-components/components/table-add-row-column-button)** - For adding new rows and columns
- **[Table Sort Row/Column Button](/ui-components/components/table-sort-row-column-button)** - For sorting rows and columns
- **[Table Clear Row/Column Content Button](/ui-components/components/table-clear-row-column-content-button)** - For clearing content without deletion
- **[Table Node (TableKit)](/ui-components/node-components/table-node)** - The core table node extension
- **Table Handle Extension** - Required extension for context detection
